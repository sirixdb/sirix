WARNING: A restricted method in java.lang.System has been called
WARNING: java.lang.System::load has been called by net.rubygrapefruit.platform.internal.NativeLibraryLoader in an unnamed module (file:/home/johannes/.gradle/wrapper/dists/gradle-9.1.0-bin/9agqghryom9wkf8r80qlhnts3/gradle-9.1.0/lib/native-platform-0.22-milestone-28.jar)
WARNING: Use --enable-native-access=ALL-UNNAMED to avoid a warning for callers in this module
WARNING: Restricted methods will be blocked in a future release unless native access is enabled


> Task :sirix-core:compileJava
/home/johannes/IdeaProjects/sirix/bundles/sirix-core/src/main/java/io/sirix/page/KeyValueLeafPage.java:1021: warning: [removal] finalize() in Object has been deprecated and marked for removal
  protected void finalize() {
                 ^
Note: Some input files use or override a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
1 warning

> Task :sirix-core:processResources UP-TO-DATE
> Task :sirix-core:classes
> Task :sirix-core:compileTestJava UP-TO-DATE
> Task :sirix-core:processTestResources UP-TO-DATE
> Task :sirix-core:testClasses UP-TO-DATE
WARNING: A restricted method in java.lang.foreign.Linker has been called
WARNING: java.lang.foreign.Linker::downcallHandle has been called by io.sirix.cache.LinuxMemorySegmentAllocator in an unnamed module (file:/home/johannes/IdeaProjects/sirix/bundles/sirix-core/build/classes/java/main/)
WARNING: Use --enable-native-access=ALL-UNNAMED to avoid a warning for callers in this module
WARNING: Restricted methods will be blocked in a future release unless native access is enabled

WARNING: A terminally deprecated method in sun.misc.Unsafe has been called
WARNING: sun.misc.Unsafe::arrayBaseOffset has been called by net.openhft.hashing.UnsafeAccess (file:/home/johannes/.gradle/caches/modules-2/files-2.1/net.openhft/zero-allocation-hashing/0.16/ca252f328160ed5d027f100a4fe525d6d21daaf/zero-allocation-hashing-0.16.jar)
WARNING: Please consider reporting this to the maintainers of class net.openhft.hashing.UnsafeAccess
WARNING: sun.misc.Unsafe::arrayBaseOffset will be removed in a future release

>>> SHUTDOWN HOOK running at 1761859140329
22:19:00.329 [Thread-3] INFO  i.s.c.LinuxMemorySegmentAllocator - Shutting down LinuxMemorySegmentAllocator...
22:19:00.330 [Thread-3] INFO  i.s.c.LinuxMemorySegmentAllocator - Cleaning up allocator (physical memory: 0 MB)
22:19:00.399 [Thread-3] INFO  i.s.c.LinuxMemorySegmentAllocator - LinuxMemorySegmentAllocator cleanup complete
22:19:00.399 [Thread-3] INFO  i.s.c.LinuxMemorySegmentAllocator - LinuxMemorySegmentAllocator shutdown complete.

> Task :sirix-core:test FAILED

VersioningTest > testIncremental() STANDARD_OUT
    22:18:59.720 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - ========== Initializing UmbraDB-Style Memory Allocator ==========
    22:18:59.722 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Physical memory limit: 16384 MB
    22:18:59.724 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Detected base page size: 4096 bytes
    22:18:59.724 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Detected huge page size: 2 MB
    22:18:59.724 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Virtual address space required: 28 GB
    22:18:59.725 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocating virtual memory regions...
    22:18:59.725 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 0 (4096 bytes per segment)
    22:18:59.763 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 0 initialized with 1048576 pre-allocated segments
    22:18:59.763 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 1 (8192 bytes per segment)
    22:18:59.778 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 1 initialized with 524288 pre-allocated segments
    22:18:59.778 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 2 (16384 bytes per segment)
    22:18:59.785 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 2 initialized with 262144 pre-allocated segments
    22:18:59.786 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 3 (32768 bytes per segment)
    22:18:59.790 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 3 initialized with 131072 pre-allocated segments
    22:18:59.790 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 4 (65536 bytes per segment)
    22:18:59.792 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 4 initialized with 65536 pre-allocated segments
    22:18:59.792 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 5 (131072 bytes per segment)
    22:18:59.793 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 5 initialized with 32768 pre-allocated segments
    22:18:59.793 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pre-allocated 4 GB virtual region for size class 6 (262144 bytes per segment)
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Pool 6 initialized with 16384 pre-allocated segments
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - =================================================================
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - Allocator initialized successfully:
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator -   - Base page size: 4096 bytes
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator -   - Huge page size: 2 MB (available)
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator -   - Virtual memory mapped: 28 GB (across 7 size classes)
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator -   - Physical memory limit: 16384 MB
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator -   - Segment size classes: [4096, 8192, 16384, 32768, 65536, 131072, 262144]
    22:18:59.794 [Test worker] INFO  i.s.c.LinuxMemorySegmentAllocator - =================================================================
    22:18:59.794 [Test worker] INFO  io.sirix.access.Databases - Initializing global BufferManager with memory budget: 16 GB
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - RecordPageCache weight: 104857600 (scaled 16x)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - RecordPageFragmentCache weight: 52428800 (scaled 16x)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - PageCache weight: 500000 (fixed)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - RevisionRootPageCache size: 5000 (fixed)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - RBTreeNodeCache size: 50000 (fixed)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - NamesCache size: 500 (fixed)
    22:18:59.795 [Test worker] INFO  io.sirix.access.Databases -   - PathSummaryCache size: 20 (fixed)

VersioningTest > testIncremental() STANDARD_ERROR
    [DiagnosticLogger] Initializing... LOG_FILE=/home/johannes/IdeaProjects/sirix/memory-leak-diagnostic.log
    [DiagnosticLogger] user.home=/home/johannes
    [DiagnosticLogger] Parent dirs created/exist: false
    [DiagnosticLogger] SUCCESS: Logging initialized at /home/johannes/IdeaProjects/sirix/memory-leak-diagnostic.log

VersioningTest > testIncremental() STANDARD_OUT
    [DiagnosticLogger] Log file: /home/johannes/IdeaProjects/sirix/memory-leak-diagnostic.log

VersioningTest > testIncremental() FAILED
    java.lang.AssertionError
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.readPage(NodePageReadOnlyTrx.java:880)
        at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:214)
        at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1716)
        at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:570)
        at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
        at java.base/java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:921)
        at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
        at java.base/java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:723)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.getPreviousPageFragments(NodePageReadOnlyTrx.java:861)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.getPageFragments(NodePageReadOnlyTrx.java:855)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.loadDataPageFromDurableStorageAndCombinePageFragments(NodePageReadOnlyTrx.java:679)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.lambda$getFromBufferManager$0(NodePageReadOnlyTrx.java:575)
        at com.github.benmanes.caffeine.cache.LocalCache.lambda$statsAware$3(LocalCache.java:201)
        at com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$remap$16(BoundedLocalCache.java:2855)
        at java.base/java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1932)
        at com.github.benmanes.caffeine.cache.BoundedLocalCache.remap(BoundedLocalCache.java:2850)
        at com.github.benmanes.caffeine.cache.BoundedLocalCache.compute(BoundedLocalCache.java:2800)
        at com.github.benmanes.caffeine.cache.LocalCache.compute(LocalCache.java:99)
        at io.sirix.cache.RecordPageCache.get(RecordPageCache.java:86)
        at io.sirix.cache.RecordPageCache.get(RecordPageCache.java:16)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.getFromBufferManager(NodePageReadOnlyTrx.java:559)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.getRecordPage(NodePageReadOnlyTrx.java:492)
        at io.sirix.access.trx.page.NodePageReadOnlyTrx.getRecord(NodePageReadOnlyTrx.java:288)
        at io.sirix.access.trx.page.NodePageTrx.getRecord(NodePageTrx.java:314)
        at io.sirix.index.name.Names.<init>(Names.java:83)
        at io.sirix.index.name.Names.fromStorage(Names.java:272)
        at io.sirix.page.NamePage.getNames(NamePage.java:205)
        at io.sirix.page.NamePage.setName(NamePage.java:328)
        at io.sirix.access.trx.page.NodePageTrx.createNameKey(NodePageTrx.java:339)
        at io.sirix.access.trx.node.xml.XmlNodeFactoryImpl.<init>(XmlNodeFactoryImpl.java:58)
        at io.sirix.access.trx.node.xml.XmlNodeTrxImpl.reInstantiateNodeFactory(XmlNodeTrxImpl.java:1996)
        at io.sirix.access.trx.node.xml.XmlNodeTrxImpl.reInstantiateNodeFactory(XmlNodeTrxImpl.java:89)
        at io.sirix.access.trx.node.AbstractNodeTrxImpl.reInstantiate(AbstractNodeTrxImpl.java:357)
        at io.sirix.access.trx.node.AbstractNodeTrxImpl.lambda$commit$0(AbstractNodeTrxImpl.java:299)
        at io.sirix.access.trx.node.AbstractNodeTrxImpl.runLocked(AbstractNodeTrxImpl.java:262)
        at io.sirix.access.trx.node.AbstractNodeTrxImpl.commit(AbstractNodeTrxImpl.java:275)
        at io.sirix.access.trx.node.xml.XmlNodeTrxImpl.commit(XmlNodeTrxImpl.java:89)
        at io.sirix.api.xml.XmlNodeTrx.commit(XmlNodeTrx.java:538)
        at io.sirix.settings.VersioningTest.test(VersioningTest.java:261)
        at io.sirix.settings.VersioningTest.testIncremental(VersioningTest.java:90)

1 test completed, 1 failed

[Incubating] Problems report is available at: file:///home/johannes/IdeaProjects/sirix/build/reports/problems/problems-report.html

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':sirix-core:test'.
> There were failing tests. See the report at: file:///home/johannes/IdeaProjects/sirix/bundles/sirix-core/build/reports/tests/test/index.html

* Try:
> Run with --scan to generate a Build Scan (Powered by Develocity).

Deprecated Gradle features were used in this build, making it incompatible with Gradle 10.

You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.

For more on this, please refer to https://docs.gradle.org/9.1.0/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.

BUILD FAILED in 12s
5 actionable tasks: 2 executed, 3 up-to-date
